# 第八章 分布式系统的问题
单机系统程序运行要么正确要么错误，分布式系统则会出现部分错误（某些节点或者网络异常）。

## 网络错误
常规解决方法是设置timeout

## 同步和异步网络
数据中心没法使用电话系统一样的同步模式。

## 不可靠的时钟
数据传输有时间间隔，而且每台电脑都有自己的时钟。电脑有两个不同时钟，一个是和NTP同步的时钟，但是同步时可能会发生时间跳跃，另一种是单调增时钟。如果程序对时间敏感，探测到有机器和整个集群偏离过大的话，应该主动停止它的服务。混淆的解决方案一般为**LWW（last write wins）**。

## 服务暂停

## 投票
每台机器都无法知道事实真相，所以需要投票表决。

## 拜占庭错误
节点可能会撒谎，这会引发拜占庭错误。拜占庭错误容忍度是指的系统可以在某些节点不服从协议的时候正常工作。比如
1. 机器出错，随机发送错误信息。
2. 比特币之类P2P系统中，有人想欺诈。

## 系统模型
考虑时间问题有三种模型:
1. 同步模型。（不可能实现）
2. 部分同步模型。（最常用）
3. 异步模型。（完全没有时间上的保证）
错误处理的模型：
1. 出错停止。（出错后节点停止）
2. 出错恢复。（出错后过一段节点恢复）
3. 拜占庭错误。（节点可能做任何事情）
